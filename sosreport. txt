TrÃ¨s bonne question ğŸ‘ â€” lâ€™analyse dâ€™un sosreport sous RHEL 9 est une compÃ©tence clÃ© pour le troubleshooting avancÃ© (niveau N3).

Voici une mÃ©thode complÃ¨te, structurÃ©e et efficace pour identifier une root cause Ã  partir dâ€™un sosreport.


---

ğŸ§  1. Comprendre ce quâ€™est un sosreport

sosreport est un snapshot complet du systÃ¨me :
il collecte automatiquement les journaux, la configuration, les statuts et les mÃ©triques.
Le rÃ©pertoire compressÃ© (ex : sosreport-hostname-YYYYMMDD.tar.xz) contient des sous-dossiers essentiels :

sos_commands/        â†’ Sorties des commandes systÃ¨me
etc/                 â†’ Fichiers de configuration
var/log/             â†’ Journaux (messages, secure, dmesgâ€¦)
sos_reports/         â†’ RÃ©sumÃ© gÃ©nÃ©ral


---

ğŸ§© 2. Extraire et prÃ©parer le rapport

mkdir /tmp/sos && cd /tmp/sos
tar -xvf /path/to/sosreport*.tar.xz

Tu verras un dossier du type :
sosreport-hostname-2025-10-25/


---

ğŸ” 3. Points clÃ©s Ã  analyser (mÃ©thode N3)

a. Journaux systÃ¨me

Chemin :

sos_commands/logs/
var/log/messages
var/log/secure
var/log/dmesg

ğŸ”¹ Chercher erreurs critiques :

grep -iE "error|fail|critical|panic|call trace" var/log/messages | tail -50
grep -iE "segfault|oom|hung" var/log/messages | tail -50

ğŸ”¹ Sur RHEL 9, le journal journald est aussi capturÃ© :

sos_commands/systemd/journalctl_--no-pager


---

b. Performance / CPU / mÃ©moire / I/O

Chemins utiles :

sos_commands/kernel/uptime
sos_commands/kernel/vmstat_-s
sos_commands/kernel/mpstat_-P_ALL_1_1
sos_commands/kernel/iostat_-x_1_1

ğŸ”¹ Identifier le top CPU consumers :

sos_commands/process/ps_auxwww
grep -iE "COMMAND|java|httpd|mcafee|tibco" sos_commands/process/ps_auxwww

ğŸ”¹ VÃ©rifier si le systÃ¨me a swapÃ© :

grep -A5 "Swap" sos_commands/kernel/free_-m

ğŸ”¹ VÃ©rifier load average :

grep "load average" sos_commands/kernel/uptime


---

c. Disk / Filesystem / LVM

Chemins :

sos_commands/filesys/df_-h
sos_commands/filesys/mount
sos_commands/lvm/vgdisplay
sos_commands/lvm/pvdisplay
sos_commands/lvm/lvdisplay

ğŸ”¹ Rechercher erreurs I/O :

grep -i "I/O error" var/log/messages

ğŸ”¹ VÃ©rifier si un FS est en read-only :

grep "Remounting filesystem read-only" var/log/messages


---

d. Network

Chemins :

sos_commands/networking/ip_addr
sos_commands/networking/ip_route_show
sos_commands/networking/nmcli_dev_show
sos_commands/networking/ss_-s

ğŸ”¹ VÃ©rifier interfaces down / bonding :

grep -i "state" sos_commands/networking/ip_link_show
grep -i "bond" sos_commands/networking/nmcli_dev_show

ğŸ”¹ Logs Network :

grep -iE "NetworkManager|eth|bond" var/log/messages


---

e. Systemd / Services

Chemin :

sos_commands/systemd/systemctl_list-units

ğŸ”¹ Chercher les services en Ã©chec :

grep failed sos_commands/systemd/systemctl_list-units

ğŸ”¹ Voir les redÃ©marrages frÃ©quents :

grep "Starting" sos_commands/systemd/journalctl_--no-pager | grep -i failed


---

âš™ï¸ 4. Utiliser les outils Red Hat pour analyse automatique

Sur RHEL 9, tu peux automatiser lâ€™analyse du sosreport :

âœ… a. sosreport-analyzer

Installation :

dnf install sos sos-collector sosreport-analyzer -y

Utilisation :

sosreport-analyzer ./sosreport-hostname-*

â¡ï¸ Produit un rÃ©sumÃ© avec les anomalies, logs, et configurations anormales.

âœ… b. Red Hat Insights (si connectÃ©)

Tu peux tÃ©lÃ©verser le rapport :

insights-client --analyze sosreport.tar.xz

â¡ï¸ Il donne un diagnostic avec recommandations (kernel, performance, sÃ©curitÃ©, etc.).


---

ğŸ§¾ 5. CorrÃ©lation root cause (exemples concrets)

Type dâ€™incident	Fichiers Ã  vÃ©rifier	Indicateur root cause

High CPU	ps, top, mpstat	Process spÃ©cifique en boucle (java, httpd, etc.)
Memory leak	free, vmstat, messages	OOM-killer entries, swap usage
FS error	dmesg, messages	ext4 error, read-only remount
Network down	ip_link, messages	interface DOWN, LACP failure
Slow failover cluster	corosync/pacemaker logs	timeout, fencing, latency



---

ğŸ§© 6. Bonnes pratiques dâ€™interprÃ©tation

Toujours corrÃ©ler les timestamps (grep "Oct 21 13:" messages) avec le moment de lâ€™incident.

Compare les mÃ©triques avant / pendant / aprÃ¨s le problÃ¨me.

VÃ©rifie les changements rÃ©cents (yum.log, rpm.log).

Note les anomalies rÃ©pÃ©tÃ©es sur plusieurs jours.



---

Si tu veux, je peux :

ğŸ§  analyser un sosreport que tu me fournis (en piÃ¨ce jointe ou listant son arborescence)

ou ğŸ‘¨â€ğŸ”§ te crÃ©er un script dâ€™analyse automatique qui fait tous ces checks (CPU, memory, logs, FS, netâ€¦).


Souhaites-tu que je te prÃ©pare ce script dâ€™analyse automatisÃ©e pour RHEL 9 ?